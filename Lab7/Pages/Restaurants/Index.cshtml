@page
@model Lab7.Pages.Restaurants.IndexModel
<h2>Restaurants</h2>

<form method="get">
    <input asp-for="NameQuery" placeholder="Search name" />
    <button type="submit">Search</button>
</form>

<table>
    <thead><tr><th>Name</th><th>Address</th><th>Dishes</th></tr></thead>
    <tbody>
        @foreach (var r in Model.Restaurants)
        {
            <tr>
                <td><a asp-page="Details" asp-route-id="@r.Id">@r.Name</a></td>
                <td>@r.Address</td>
                <td>
                    <ul>
                        @foreach (var d in r.Dishes)
                        {
                            <li>@d.Title (@d.Price) — @string.Join(", ", d.DishCategories.Select(dc => dc.Category.Name))</li>
                        }
                    </ul>
                </td>
            </tr>
        }
    </tbody>
</table>

<div>
    Page @Model.PageIndex of @Model.TotalPages
    @if (Model.PageIndex > 1)
    {
        <a asp-page="./Index" asp-route-PageIndex="@(Model.PageIndex-1)" asp-route-NameQuery="@Model.NameQuery">Prev</a>
    }
    @if (Model.PageIndex < Model.TotalPages)
    {
        <a asp-page="./Index" asp-route-PageIndex="@(Model.PageIndex+1)" asp-route-NameQuery="@Model.NameQuery">Next</a>
    }
</div>
