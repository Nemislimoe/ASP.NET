@page
@model Lab7.Pages.Dishes.IndexModel
<h2>Dishes</h2>

<form method="get">
    <label>Category</label>
    <select asp-for="CategoryId">
        <option value="">All</option>
        @foreach (var c in Model.Categories)
        {
            <option value="@c.Id" selected="@(Model.CategoryId==c.Id)">@c.Name</option>
        }
    </select>

    <label>Sort</label>
    <select asp-for="SortOrder">
        <option value="price_asc">Price asc</option>
        <option value="price_desc">Price desc</option>
    </select>

    <button type="submit">Apply</button>
</form>

<table>
    <thead><tr><th>Title</th><th>Restaurant</th><th>Price</th><th>Categories</th></tr></thead>
    <tbody>
        @foreach (var d in Model.Dishes)
        {
            <tr>
                <td><a asp-page="Details" asp-route-id="@d.Id">@d.Title</a></td>
                <td>@d.Restaurant?.Name</td>
                <td>@d.Price</td>
                <td>@string.Join(", ", d.DishCategories.Select(dc => dc.Category.Name))</td>
            </tr>
        }
    </tbody>
</table>
